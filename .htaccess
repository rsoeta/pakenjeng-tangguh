# ======================================================================
# ðŸš€ CodeIgniter 4 - Pretty URLs (No index.php) - Optimized for PHP 8.1
# IdCloudHost / LiteSpeed / cPanel environment
# ======================================================================

# --- Force PHP 8.1 ---
<IfModule mime_module>
  RemoveHandler .php
  RemoveHandler .php7
  RemoveHandler .phtml
  AddHandler application/x-httpd-alt-php81 .php .php7 .phtml
  AddType application/x-httpd-alt-php81 .php
</IfModule>

# --- Disable directory listing ---
Options -Indexes

# --- Enable Rewrite Engine ---
<IfModule mod_rewrite.c>
    Options +FollowSymlinks
    RewriteEngine On
    RewriteBase /

    # Redirect Trailing Slashes...
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$
    RewriteRule ^ %1 [L,R=301]

    # Redirect "www" to non-www
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule ^ https://%1%{REQUEST_URI} [R=301,L]

    # Send all non-existing requests to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [L,QSA]

    # Ensure Authorization header is passed along
    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
</IfModule>

# --- Litespeed keepalive ---
<IfModule litespeed>
RewriteRule .* - [E=noconntimeout:1]
</IfModule>

# --- PHP runtime settings (cPanel recommended minimal block) ---

<IfModule lsapi_module>
   php_flag display_errors On
   php_value max_execution_time 300
   php_value memory_limit 512M
   php_value upload_max_filesize 2G
   php_value post_max_size 2G
</IfModule>

<IfModule mod_mime.c>
  AddType font/ttf .ttf
  AddType font/otf .otf
  AddType application/font-woff .woff
  AddType application/font-woff2 .woff2
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(ttf|otf|woff|woff2)$">
    Header set Access-Control-Allow-Origin "*"
  </FilesMatch>
</IfModule>
