

## Catatan ##

## v2.5.2 -- Penambahan fitur profil user -- 2022-06-10
    # issue
        - sebagai syarat ekspor BA diperlukan informasi tambahan semacam Nama Pejabat setempat & sekretariat

    ** Perbaharui Database
        - tambah kolom kategori_role setelah nm_role di tabel tb_roles
        - tambah kolom user_lembaga_id(int) setelah user_image di tabel dtks_users 
        - pindah kolom password setelah kolom user_lembaga_id di tabel dtks_users 
        - impor lembaga_profil
        - impor lembaga_kategori
        - tambah kode_kec(vharchar)(100) di tabel dtks_users 
        - buat view usulan dibulan ini 
            CREATE OR REPLACE VIEW dtks_usulan_view AS
                SELECT dtks_usulan22.du_id, dtks_usulan22.du_nik
            FROM 
                dtks_usulan22 
            WHERE 
                dtks_usulan22.created_at_year = year(now()) and dtks_usulan22.created_at_month = month(now());

    
---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.6.0 -- Penambahan fitur impor CSV Report -- 2022-06-10
    # issue
        - hasil ekspor dari siks online tidak menampilkan nama, alamat, dll terusul.

    * solusi
        - mempermudah operator dalam menemukan nama, alamat dari NIK terusul.

    ** Permbaharuan Database 
        - tambah tabel dtks_csv_report
        - buat view join tabel dtks_csv_report (hasil ekspor siks online) & tabel dtks_usulan22

            CREATE OR REPLACE VIEW vw_csv_report AS
                SELECT cr_id, kecamatan, cr_nama_kec, kelurahan, cr_nama_desa, nokk, nama, cr_nama_lgkp, du_nik, alamat, rt, rw, program_bansos,
                cr_program_bansos, cr_hasil, cr_padan, cr_ket_vali, cr_ck_id, YEAR(cr_created_at) as tahun_upload, MONTH(cr_created_at) as bulan_upload, cr_created_by, cr_created_at
            FROM 
                dtks_csv_report
            INNER JOIN 
                dtks_usulan22 ON dtks_csv_report.cr_nik_usulan = dtks_usulan22.du_nik;


            ALTER 
                ALGORITHM=MERGE
            VIEW vw_csv_report AS
                SELECT cr_id, kecamatan, cr_nama_kec, kelurahan, cr_nama_desa, nokk, nama, cr_nama_lgkp, du_nik, alamat, rt, rw, program_bansos,
                cr_program_bansos, cr_hasil, cr_padan, cr_ket_vali, cr_ck_id, cr_created_by, cr_created_at
            FROM 
                dtks_csv_report
            INNER JOIN 
                dtks_usulan22 ON dtks_csv_report.cr_nik_usulan = dtks_usulan22.du_nik;


        - tambah tabel dtks_csv_ket dengan struktur: Terproses, Error, Tidak valid, Valid, Belum dipadankan dukcapil, Padan dukcapil, Tidak padan dukcapil
        - ubah struktur tabel dtks_csv_ket dengan ditambah cr_ck_id
---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.7.0 -- Penambahan fitur dan Menu Perbaikan data Anomali -- 2022-06-17
    # issue
        - Perbaikan data anomali agar dapat di akses dan informasikan kepada user tk. RW

    * solusi
        - Janten kan pakenjeng-tangguh.id th akses na tiasa di filter dugika ka tingkat RW, Numawi siks online mah akses na kan dugika tingkat desa, numawi dijembatani ku pakenjeng-tangguh.id. 
        Teras Kasus nu ayeuna nuju di verivali th nya√©ta data anomali isina (tidak ada tanggal lahir, nama ibu, pekerjaan dsb). 
        Tiasa ke ketua RW verivali na dina pakenjeng-tangguh.id, ke eksekusi na ku operator desa kana siks.kemensos.go.id daripada kedah ngempel keun KK nu masyarakat, mending via aplikasi pakenjeng-tangguh.id.

    ** perbaikan Database
        - tambah tabel dtks_verivali_anomali
        dengan struktur :
                            va_id,
                            va_id_dtks,
                            va_nik,
                            va_nama,
                            va_nkk,
                            va_tmp_lhr,
                            va_tgl_lhr,
                            va_alamat,
                            va_provinsi,
                            va_kab,
                            va_kec,
                            va_desa,
                            va_jk,
                            va_ibu,
                            va_pekerjaan,
                            va_rw,
                            va_nama_anomali,
                            va_status,
                            va_creator,

        - buat view untuk tabel userinterface 
            CREATE OR REPLACE VIEW vw_verivali_anomali AS
                SELECT 
                    va_id,
                    db_id_dtks,
                    db_province,
                    db_regency,
                    db_district,
                    db_village,
                    db_alamat,
                    db_dusun,
                    db_rw,
                    va_rw,
                    db_rt,
                    db_nkk,
                    db_nik,
                    db_nama,
                    db_tgl_lahir,
                    db_tmp_lahir,
                    db_jenkel_id,
                    db_ibu_kandung,
                    va_pekerjaan,
                    va_nama_anomali,
                    va_ds_id,
                    va_status,
                    va_updated_at
                FROM 
                    ((dtks_bnba
                INNER JOIN 
                    dtks_verivali_anomali ON dtks_bnba.db_id_dtks = dtks_verivali_anomali.va_id_dtks)
                INNER JOIN
                    dtks_status ON dtks_verivali_anomali.va_ds_id = id_status);

        - tambah tabel tb_penduduk_pekerjaan
        - tambah tabel tb_ket_anomali
        - tambah tabel tb_status
---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.7.1 -- Penambahan fitur dan Menu Perbaikan data Anomali -- 2022-06-17
    # bug tidak ada status anomali bahwa sudah meninggal atau belum
        - ubah tabel dtks_verivali_anomali dengan ditambah va_ds_id
            ALTER TABLE dtks_verivali_anomali
                ADD COLUMN va_ds_id INT DEFAULT 1 AFTER va_status;

                ALTER TABLE dtks_verivali_anomali
                MODIFY va_ds_id INT DEFAULT '1';

        - replace view vw_verivali_anomali 
            CREATE OR REPLACE VIEW vw_verivali_anomali AS
                SELECT 
                    va_id,
                    db_id_dtks,
                    db_province,
                    db_regency,
                    db_district,
                    db_village,
                    db_alamat,
                    db_dusun,
                    db_rw,
                    va_rw,
                    db_rt,
                    db_nkk,
                    db_nik,
                    db_nama,
                    db_tgl_lahir,
                    db_tmp_lahir,
                    db_jenkel_id,
                    db_ibu_kandung,
                    va_pekerjaan,
                    va_nama_anomali,
                    va_ds_id,
                    va_status,
                    va_updated_at
                FROM 
                    ((dtks_bnba
                INNER JOIN 
                    dtks_verivali_anomali ON dtks_bnba.db_id_dtks = dtks_verivali_anomali.va_id_dtks)
                INNER JOIN
                    dtks_status ON dtks_verivali_anomali.va_ds_id = id_status);

        - ubah tabel dtks_status, ditambah kolom ds_class
        - ubah tabel tb_ket_anomali, ditambah kolom sta_class
        - ubah tabel tb_status, ditambah kolom sta_class
        - ubah view vw_verivali_anomali
---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.8.0 -- Penambahan fitur dan Menu PDTT -- 2022-06-22
    # issue
        - PM harus difoto dengan foto Geotagging,

    * solusi
        - Tambh fitur Geotagging ke aplikasi,
        - Dokumentasi PM tersimpan di database pakenjeng-tangguh.id,

    ** perbaikan Database
        - tambah tabel dtks_verivali_geo
        dengan struktur :
                            vg_id,
                            vg_nik,
                            vg_nama_lengkap,
                            vg_nkk,
                            vg_alamat,
                            vg_rw,
                            vg_rt,
                            vg_desa,
                            vg_kec,
                            vg_kab,
                            vg_prov,
                            vg_dbj_id1,
                            vg_dbj_id2,
                            vg_norek,
                            vg_source,
                            vg_fp,
                            vg_fr,
                            vg_lat,
                            vg_lang,
                            vg_ds_id,
                            vg_sta_id,
                            vg_created_by,
                            vg_created_at,
                            vg_updated_by,
                            vg_updated_at,

    # issue
        - ubah tab verivali anomali menjadi tabel verivali, proses verivali dan hasil verivali

    ** perbaikan tb_status insert data value sta_id = 2, sta_nama = Sukses

    # issue
        - ubah tabel sesuai data revisi 3.2.8
    ** perbaikan table dtks_verivali_geo tambah column no. vg_no_data, vg_nik_ktp, vg_nama_ktp, vg_fktp, vg_fkk, vg_terbukti, 
    ** tambah tabel tb_ket_temuan dengan struktur : tkt_id, tkt_num, tkt_ket 
    ---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.8.1 -- Perbaikan Fitur Setting Web tingkat Kecamatan di Kabupaten Garut -- 2022-07-01
    
    # bug setting awal aplikasi untuk digunakan oleh Admin Kecamatan
        - ubah tabel dtks_users MODIFY kode_kab DEFAULT ke 32.05

    # tambah landing-page dengan fitur menampilkan cek usulan cpm
        - tambah tabel tb_bulan
---------------------------------------------------------------------------------------------------------------------------------------------------            

## v2.8.2 -- Penambahan fitur Verivali BNBA KESOS -- 2022-07-23

    # perbaikan tabel dtks_bnba tambah kolom db_tgl_kejadian, db_noreg_kejadian, db_tb_status setelah kolom db_status

## v2.8.3 -- Penambahan fitur Pengaturan Menu terintegrasi ke database
    # buat tabel baru dengan nama tb_menu
    # buat tabel baru dengan nama tb_version
    # perbaikan tabel dtks_status

---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.8.4 -- Perbaikan Bug Profil Lembaga Admin Kecamatan & Ekspor BA PDTT -- 2022-07-24
    # template BA PDTT bagi Admin
    # perbaiki table dtks_status, keterangan Menolak menjadi Sudah Mampu/Menolak
    # perbaiki table dtks_users, tambah kolom jabatan_id int(11) setelah status
    # tambah tabel tb_jabatan
    # tambah tabel dtks_deadline

## v2.9.0 -- tambah fitur online user
    # tambah tabel tb_chatt
    # tambah tabel dtks_users_login

---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.9.1 -- tambah fitur rekap pbi_nonaktif
    # tambah table dtks_pbi_nonaktif

---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.10.0 -- tambah fitur / menu DKM (Daftar Keluarga Kemiskinan)
    # tambah tabel dtks_dkm

---------------------------------------------------------------------------------------------------------------------------------------------------

## v2.11.0 -- tambah fitur / proses usulan sukses / gagal
    # tambah field di tabel dtks_usulan22: ALTER TABLE `dtks_usulan22` ADD `du_proses` INT NULL DEFAULT NULL AFTER `hamil_tgl`;

---------------------------------------------------------------------------------------------------------------------------------------------------
## v2.12.0 -- penyesuaian versi SIKS-NG 0.8.19
    # tambah foto KTP & Rumah
        - tambah field baru di tabel dtks_usulan22: ALTER TABLE `dtks_usulan22` ADD `foto_identitas` VARCHAR(255) NULL DEFAULT NULL AFTER `shdk`;
        - tambah field baru di tabel dtks_usulan22: ALTER TABLE `dtks_usulan22` ADD `du_latitude` VARCHAR(255) NULL DEFAULT NULL AFTER `hamil_tgl`, ADD `du_longitude` VARCHAR(255) NULL DEFAULT NULL AFTER `du_latitude`;
        - tambah directory penyimpanan foto tersebut

---------------------------------------------------------------------------------------------------------------------------------------------------
## v2.13.0 -- distinct cari data
    # tambah table view dtks_usulan_view_nik sebagai alat bantu
        CREATE OR REPLACE VIEW dtks_usulan_view_nik AS
        SELECT DISTINCT du_nik
        FROM dtks_usulan22;

        CREATE OR REPLACE VIEW dtks_usulan_caridata AS
        SELECT dtks_usulan22.du_id, dtks_usulan22.du_nik, dtks_usulan22.program_bansos, dtks_usulan22.nokk, dtks_usulan22.nama, dtks_usulan22.tempat_lahir, dtks_usulan22.tanggal_lahir, dtks_usulan22.ibu_kandung, dtks_usulan22.jenis_kelamin, dtks_usulan22.jenis_pekerjaan, dtks_usulan22.status_kawin, dtks_usulan22.alamat, dtks_usulan22.rt, dtks_usulan22.rw, dtks_usulan22.provinsi, dtks_usulan22.kabupaten, dtks_usulan22.kecamatan, dtks_usulan22.kelurahan, dtks_usulan22.shdk, dtks_usulan22.foto_identitas, dtks_usulan22.foto_rumah, dtks_usulan22.disabil_status, dtks_usulan22.disabil_kode, dtks_usulan22.hamil_status, dtks_usulan22.hamil_tgl, dtks_usulan22.du_latitude, dtks_usulan22.du_longitude, dtks_usulan22.du_proses, dtks_usulan22.created_at, dtks_usulan22.created_at_year, dtks_usulan22.created_at_month, dtks_usulan22.created_by, dtks_usulan22.updated_at, dtks_usulan22.updated_by
        FROM dtks_usulan22
        JOIN dtks_usulan_view_nik ON dtks_usulan22.du_nik=dtks_usulan_view_nik.du_nik;

        CREATE OR REPLACE VIEW dtks_usulan_caridata AS
        SELECT DISTINCT dtks_usulan22.du_nik, dtks_usulan22.program_bansos, dtks_usulan22.nokk, dtks_usulan22.nama, dtks_usulan22.tempat_lahir, dtks_usulan22.tanggal_lahir, dtks_usulan22.ibu_kandung, dtks_usulan22.jenis_kelamin, dtks_usulan22.jenis_pekerjaan, dtks_usulan22.status_kawin, dtks_usulan22.alamat, dtks_usulan22.rt, dtks_usulan22.rw, dtks_usulan22.provinsi, dtks_usulan22.kabupaten, dtks_usulan22.kecamatan, dtks_usulan22.kelurahan, dtks_usulan22.shdk
        FROM dtks_usulan22
        JOIN dtks_usulan_view_nik ON dtks_usulan22.du_nik=dtks_usulan_view_nik.du_nik;

        3205336606740001

        SET GLOBAL sql_mode=(SELECT REPLACE(@@sql_mode,'ONLY_FULL_GROUP_BY',''));
        CREATE OR REPLACE VIEW dtks_usulan_caridata AS
        SELECT COUNT(dtks_usulan22.du_nik) AS rc, dtks_usulan22.du_id, dtks_usulan22.du_nik, dtks_usulan22.program_bansos, dtks_usulan22.nokk, dtks_usulan22.nama, dtks_usulan22.tempat_lahir, dtks_usulan22.tanggal_lahir, dtks_usulan22.ibu_kandung, dtks_usulan22.jenis_kelamin, dtks_usulan22.jenis_pekerjaan, dtks_usulan22.status_kawin, dtks_usulan22.alamat, dtks_usulan22.rt, dtks_usulan22.rw, dtks_usulan22.provinsi, dtks_usulan22.kabupaten, dtks_usulan22.kecamatan, dtks_usulan22.kelurahan, dtks_usulan22.shdk, dtks_usulan22.foto_identitas, dtks_usulan22.foto_rumah, dtks_usulan22.disabil_status, dtks_usulan22.disabil_kode, dtks_usulan22.hamil_status, dtks_usulan22.hamil_tgl, dtks_usulan22.du_latitude, dtks_usulan22.du_longitude, dtks_usulan22.du_proses, dtks_usulan22.created_at, dtks_usulan22.created_at_year, dtks_usulan22.created_at_month, dtks_usulan22.created_by, dtks_usulan22.updated_at, dtks_usulan22.updated_by
        FROM dtks_usulan22
        GROUP BY dtks_usulan22.du_nik;